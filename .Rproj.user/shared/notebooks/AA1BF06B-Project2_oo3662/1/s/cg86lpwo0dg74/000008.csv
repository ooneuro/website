"0",""
"0","#ROC plot"
"0",""
"0","data <-den"
"0","data$y <- data$sym"
"0","data$prob <- data$phh"
"0","sens<-function(p,data=data, y=y) mean(data[data$y==1,]$prob>p)"
"0","spec<-function(p,data=data, y=y) mean(data[data$y==0,]$prob<p)"
"0","sensitivity<-sapply(seq(0,1,.01),sens,data)"
"0","specificity<-sapply(seq(0,1,.01),spec,data)"
"0","ROC1<-data.frame(sensitivity,specificity,cutoff=seq(0,1,.01))"
"0","#ROC1%>%gather(key,rate,-cutoff)%>%ggplot(aes(cutoff,rate,color=key))+geom_path()+"
"0","# geom_vline(xintercept=c(.1,.5),lty=2,color=""gray50"")"
"0","ROC1$TPR<-sensitivity"
"0","ROC1$FPR<-1-specificity"
"0","ROC1%>%ggplot(aes(FPR,TPR))+geom_path(size=1.5)+geom_segment(aes(x=0,y=0,xend=1,yend=1),lty=2)+"
"0","  scale_x_continuous(limits = c(0,1))"
