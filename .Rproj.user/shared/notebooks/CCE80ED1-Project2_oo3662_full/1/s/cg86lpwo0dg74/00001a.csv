"0",""
"0","den1 <- data"
"0","#####"
"0","auc(den1$y,prob)"
"1","[1]"
"1"," 0.8996212"
"1","
"
"0","# 10-fold (or repeated random sub-sampling) CV"
"0",""
"0","set.seed(1234)"
"0","k=5 #choose number of folds"
"0","data1<-den1[sample(nrow(den1)),] #randomly order rows"
"0","folds<-cut(seq(1:nrow(den1)),breaks=k,labels=F) #create folds"
"0","diags<-NULL"
"0","for(i in 1:k){"
"0","  ## Create training and test sets"
"0","  train<-data1[folds!=i,]"
"0","  test<-data1[folds==i,]"
"0","  truth<-test$y"
"0","  ## Train model on training set"
"0","  fit<-glm(sym~Condition+ZLen+Prots+sp+filo+stubby+CFA+PSD, data=train, family=""binomial"")"
"0","  probs<-predict(fit,newdata = test,type=""response"")"
"0","  ## Test model on test set (save all k results)"
"0","  diags<-rbind(diags,class_diag(probs,truth))"
"0","}"
"0","apply(diags,2,mean) #average across all k results"
"1","      acc "
"1","     sens "
"1","     spec "
"1","      ppv "
"1","      auc "
"1","
"
"1","0.7533333 "
"1","0.6666667 "
"1","0.8092857 "
"1","0.7033333 "
"1","0.7928571 "
"1","
"
