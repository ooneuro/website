"0","############## 5. Logistic Regression"
"0","####don't touch"
"0","class_diag<-function(probs,truth){"
"0","  "
"0","  tab<-table(factor(probs>.5,levels=c(""FALSE"",""TRUE"")),truth)"
"0","  acc=sum(diag(tab))/sum(tab)"
"0","  sens=tab[2,2]/colSums(tab)[2]"
"0","  spec=tab[1,1]/colSums(tab)[1]"
"0","  ppv=tab[2,2]/rowSums(tab)[2]"
"0","  "
"0","  if(is.numeric(truth)==FALSE & is.logical(truth)==FALSE) truth<-as.numeric(truth)-1"
"0","  "
"0","  #CALCULATE EXACT AUC"
"0","  ord<-order(probs, decreasing=TRUE)"
"0","  probs <- probs[ord]; truth <- truth[ord]"
"0","  "
"0","  TPR=cumsum(truth)/max(1,sum(truth)) "
"0","  FPR=cumsum(!truth)/max(1,sum(!truth))"
"0","  "
"0","  dup<-c(probs[-1]>=probs[-length(probs)], FALSE)"
"0","  TPR<-c(0,TPR[!dup],1); FPR<-c(0,FPR[!dup],1)"
"0","  "
"0","  n <- length(TPR)"
"0","  auc<- sum( ((TPR[-1]+TPR[-n])/2) * (FPR[-1]-FPR[-n]) )"
"0","  "
"0","  data.frame(acc,sens,spec,ppv,auc)"
"0","}"
"0","######end don't touch"
"0",""
"0","### "
"0","#View(den)"
"0","fit5<-glm(sym~Condition+ZLen+Prots+sp+filo+stubby+CFA+PSD, data=den, family=""binomial"")"
"0","summary(fit5)"
"1","
Call:
"
"1",""
"1","glm(formula = sym ~ Condition + ZLen + Prots + sp + filo + stubby + 
    CFA + PSD, family = ""binomial"", data = den)"
"1",""
"1","

"
"1","Deviance Residuals: 
"
"1","    Min  "
"1","     1Q  "
"1"," Median  "
"1","     3Q  "
"1","    Max  "
"1","
"
"1","-1.6396  "
"1","-0.5471  "
"1","-0.2511  "
"1"," 0.5128  "
"1"," 2.2891  "
"1","
"
"1","
Coefficients:
"
"1","                 "
"1"," Estimate"
"1"," Std. Error"
"1"," z value"
"1"," Pr(>|z|)"
"1","  "
"1","
(Intercept)      "
"1","  -3.6442"
"1","     2.4256"
"1","  -1.502"
"1","   0.1330"
"1","  "
"1","
ConditionPerfused"
"1","   2.9745"
"1","     1.6330"
"1","   1.821"
"1","   0.0685"
"1"," ."
"1","
ConditionTBS     "
"1","   2.3163"
"1","     1.4625"
"1","   1.584"
"1","   0.1132"
"1","  "
"1","
ZLen             "
"1","  -0.2927"
"1","     0.2639"
"1","  -1.109"
"1","   0.2674"
"1","  "
"1","
Prots            "
"1","   0.2620"
"1","     0.2056"
"1","   1.274"
"1","   0.2025"
"1","  "
"1","
sp               "
"1","   0.1393"
"1","     0.3811"
"1","   0.366"
"1","   0.7147"
"1","  "
"1","
filo             "
"1","  -0.6717"
"1","     0.8256"
"1","  -0.814"
"1","   0.4159"
"1","  "
"1","
stubby           "
"1","   0.4788"
"1","     0.4848"
"1","   0.988"
"1","   0.3234"
"1","  "
"1","
CFA              "
"1","  14.3379"
"1","    13.1922"
"1","   1.087"
"1","   0.2771"
"1","  "
"1","
PSD              "
"1","  -5.0865"
"1","    12.4910"
"1","  -0.407"
"1","   0.6838"
"1","  "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1",""
"1","binomial"
"1",""
"1"," family taken to be "
"1",""
"1","1"
"1",""
"1",")

"
"1",""
"1","    Null deviance: 61.906  on 48  degrees of freedom
"
"1",""
"1","Residual deviance: 36.673  on 39  degrees of freedom
"
"1","AIC: "
"1",""
"1","56.673"
"1",""
"1","

"
"1",""
"1","Number of Fisher Scoring iterations: "
"1",""
"1","6"
"1",""
"1","
"
"1","
"
"0","exp(coef(fit5))"
"1","      (Intercept) "
"1","ConditionPerfused "
"1","     ConditionTBS "
"1","             ZLen "
"1","
"
"1","     2.614194e-02 "
"1","     1.957902e+01 "
"1","     1.013817e+01 "
"1","     7.462360e-01 "
"1","
"
"1","            Prots "
"1","               sp "
"1","             filo "
"1","           stubby "
"1","
"
"1","     1.299558e+00 "
"1","     1.149497e+00 "
"1","     5.108470e-01 "
"1","     1.614088e+00 "
"1","
"
"1","              CFA "
"1","              PSD "
"1","
"
"1","     1.686034e+06 "
"1","     6.179344e-03 "
"1","
"
"0","den$phh<-predict(fit5,type=""response"")"
"0","ggplot(den, aes(CFA,phh))+geom_point(aes(color=as.factor(sym)),alpha=.7,size=5)+"
"0","  geom_rug(aes(color=as.factor(sym)),sides=""right"")"
