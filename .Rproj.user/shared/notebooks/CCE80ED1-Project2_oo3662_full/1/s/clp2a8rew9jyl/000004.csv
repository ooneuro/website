"0","####################  6. LASSO"
"0","#"
"0","fit5<-glm(sym~Condition+ZLen+Prots+sp+filo+stubby+CFA+PSD, data=den, family=""binomial"")"
"0","den$phh<-predict(fit5,type=""response"")"
"0","#ggplot(den, aes(CFA,phh))+geom_point(aes(color=as.factor(sym)),alpha=.7,size=5)+"
"0","# geom_rug(aes(color=as.factor(sym)),sides=""right"")"
"0","prob <- predict(fit5, type = ""response"")"
"0",""
"0","y<-as.matrix(den$sym)"
"0","x <- model.matrix(fit5) "
"0","x <-x[,-1] "
"0","x <- scale(x)"
"0","cv<-cv.glmnet(x,y, family=""binomial"")"
"0","lasso <- glmnet(x,y,lambda = cv$lambda.1se, family=""binomial"")"
"0","coef(lasso)"
"1","10 x 1 sparse Matrix of class ""dgCMatrix""
"
"1","                 "
"1","          s0"
"1","
(Intercept)      "
"1"," -0.74366485"
"1","
ConditionPerfused"
"1","  0.31690525"
"1","
ConditionTBS     "
"1","  .         "
"1","
ZLen             "
"1","  .         "
"1","
Prots            "
"1","  .         "
"1","
sp               "
"1","  .         "
"1","
filo             "
"1","  .         "
"1","
stubby           "
"1","  .         "
"1","
CFA              "
"1","  .         "
"1","
PSD              "
"1","  0.08550112"
"1","
"
"0","# Create a new table for running only lasso-var glm"
"0","den2 <- den %>% mutate(Perfused = Condition) %>% dplyr::select(-Condition)"
"0","den2$Perfused <- ifelse(den2$Perfused == ""Perfused"", 1,0)"
"0","den2$y <- den2$sym"
"0","den2$prob <- den2$phh"
"0","#View(den2)"
"0",""
"0","# Re-fit glm with only lasso-variables"
"0","fit6 <- glm(sym~Perfused+PSD, data=den2, family = ""binomial"")"
"0","prob6 <- predict(fit6, type = ""response"")"
"0","# Classification Diagnostics"
"0","class_diag(prob6, den2$sym)"
