"0","table(predict=as.numeric(prob6>.5),truth=den2$sym)%>%addmargins"
"1","       truth
"
"1","predict"
"1","  0"
"1","  1"
"1"," Sum"
"1","
    0  "
"1"," 29"
"1","  5"
"1","  34"
"1","
    1  "
"1","  4"
"1"," 11"
"1","  15"
"1","
    Sum"
"1"," 33"
"1"," 16"
"1","  49"
"1","
"
"0","# 5-fold CV"
"0","set.seed(1234)"
"0","k=5 #choose number of folds"
"0","data2<-den2[sample(nrow(den2)),] #randomly order rows"
"0","folds<-cut(seq(1:nrow(den2)),breaks=k,labels=F) #create folds"
"0","diags<-NULL"
"0","for(i in 1:k){"
"0","  ## Create training and test sets"
"0","  train<-data2[folds!=i,]"
"0","  test<-data2[folds==i,]"
"0","  truth<-test$y"
"0","  ## Train model on training set"
"0","  fit <- glm(sym~Perfused+PSD, data=train, family = ""binomial"")"
"0","  probs<-predict(fit,newdata = test,type=""response"")"
"0","  ## Test model on test set (save all k results)"
"0","  diags<-rbind(diags,class_diag(probs,truth))"
"0","}"
"0","apply(diags,2,mean) #average across all k results"
"1","      acc "
"1","     sens "
"1","     spec "
"1","      ppv "
"1","      auc "
"1","
"
"1","0.7755556 "
"1","0.6666667 "
"1","0.8528571 "
"1","0.7166667 "
"1","0.8209524 "
"1","
"
"0","####"
"0",""
"0",""
