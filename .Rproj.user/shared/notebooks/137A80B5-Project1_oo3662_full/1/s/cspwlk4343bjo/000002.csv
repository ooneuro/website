"0","# creating pca table (normalizing and scaling the variables) and summary of PCs and their coefficients. "
"0","txypca1 <- txypca %>% select(-city) %>% scale()"
"0","rownames(txypca1)<-txypca$city"
"0","View(txypca1)"
"0","pca<-princomp(txypca1)"
"0","names(pca)"
"1","[1]"
"1"," ""sdev""    "
"1"," ""loadings"""
"1"," ""center""  "
"1"," ""scale""   "
"1"," ""n.obs""   "
"1"," ""scores""  "
"1"," ""call""    "
"1","
"
"0","summary(pca, loadings=T)"
"1","Importance of components:
"
"1","                      "
"1","    Comp.1"
"1","    Comp.2"
"1","     Comp.3"
"1","    Comp.4"
"1","      Comp.5"
"1","
Standard deviation    "
"1"," 1.8102420"
"1"," 1.3666585"
"1"," 0.75636817"
"1"," 0.3594470"
"1"," 0.183384774"
"1","
Proportion of Variance"
"1"," 0.5566658"
"1"," 0.3172789"
"1"," 0.09718243"
"1"," 0.0219478"
"1"," 0.005712784"
"1","
Cumulative Proportion "
"1"," 0.5566658"
"1"," 0.8739447"
"1"," 0.97112717"
"1"," 0.9930750"
"1"," 0.998787764"
"1","
"
"1","                      "
"1","      Comp.6"
"1","
Standard deviation    "
"1"," 0.084475935"
"1","
Proportion of Variance"
"1"," 0.001212236"
"1","
Cumulative Proportion "
"1"," 1.000000000"
"1","
"
"1","
Loadings:
"
"1","         "
"1"," Comp.1"
"1"," Comp.2"
"1"," Comp.3"
"1"," Comp.4"
"1"," Comp.5"
"1"," Comp.6"
"1","
year     "
"1","  0.308"
"1","  0.510"
"1","  0.519"
"1","  0.436"
"1","  0.417"
"1","  0.109"
"1","
sales    "
"1"," -0.436"
"1","  0.421"
"1"," -0.195"
"1"," -0.111"
"1","       "
"1","  0.762"
"1","
volume   "
"1"," -0.278"
"1","  0.610"
"1"," -0.168"
"1","  0.235"
"1"," -0.439"
"1"," -0.523"
"1","
median   "
"1","  0.471"
"1","  0.275"
"1","  0.321"
"1"," -0.607"
"1"," -0.473"
"1","       "
"1","
listings "
"1"," -0.505"
"1","  0.120"
"1","  0.353"
"1"," -0.548"
"1","  0.447"
"1"," -0.326"
"1","
inventory"
"1"," -0.401"
"1"," -0.318"
"1","  0.661"
"1","  0.272"
"1"," -0.457"
"1","  0.136"
"1","
"
"0","eigval<-pca$sdev^2 #square to convert SDs to eigenvalues"
"0","varprop=round(eigval/sum(eigval),2) #proportion of var explained by each PC"
"0",""
"0","# The plot of cumulative proportions"
"0","ggplot()+geom_bar(aes(y=varprop,x=1:6),stat=""identity"")+xlab("""")+"
"0","  geom_path(aes(y=varprop,x=1:6))+"
"0","  geom_text(aes(x=1:6,y=varprop,label=round(varprop,2)),vjust=1,col=""white"",size=5)+"
"0","  scale_y_continuous(breaks=seq(0,.6,.2),labels = scales::percent)+"
"0","  scale_x_continuous(breaks=1:10)"
